name: Python CI

# Se ejecuta cuando haces push o pull request a la rama main (o master)
on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # 1. Descarga tu código del repositorio
    - name: "Checkout repo"
    - uses: actions/checkout@v4

    # 2. Instala Python (versión 3.12, puedes cambiarla)
    - name: Set up Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"

    # 3. Instala dependencias
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pytest
        # Si tienes un requirements.txt, lo instala
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

    # 4. Ejecuta los tests
    # IMPORTANTE: Usamos 'python -m pytest' para arreglar el error de importación 'src'
    - name: Run tests with pytest
      run: |
        export PYTHONPATH=$PYTHONPATH:.
        python -m pytest


